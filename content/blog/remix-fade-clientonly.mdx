---
title: Fade in content on the client to avoid hydration issues in Remix
description: React doesn't like mismatches between client and server rendering. Avoid it by rendering tricky content like dates only on the client. Fade it in for a smooth UI and to avoid layout shift.
tags: Remix
timestamp: "2023-05-23"
published: true
---

For all the benefits of serverside rendering, there are also things it makes more difficult, like [showing the same date in the client and the server](/content/remix-ssr-dates).

If you do those poorly you can end up with a flash of unstyled content (FOUC) or a flash of incorrect content (FOIC). You might get hydration errors and cause your site to bail on serverside rendering entirely.

One solution, which doesn't really solve the problem so much as it bypasses it, is to tell the server to ignore the problematic content entirely.

The `useHydrated` hook from [Remix Utils](https://github.com/sergiodxa/remix-utils) is the core of this solution. It's a React hook that returns `true` if the component is being rendered on the client, and `false` if it's being rendered on the server.<SideNote> Also false the first render on the client so React doesn't yell about hydration issues. </SideNote>

```ts
import { useHydrated } from "remix-utils"

function Example() {
  const { date } = useLoaderData()
  const isHydrated = useHydrated()

  return isHydrated ? (
    <p> {date.toLocaleDateString()} </p>
  ) : null
}
```

This isn't very elegant for a few reasons.

- There's no progressive enhancement here. If the user has JavaScript disabled, they'll never see the date. If you want that to work, you'll need to [use a CSS animation to reveal the content after the page loads.](/content/remix-hide-on-load).
- The date will just pop in after the page loads, which can cause content layout shift that's jarring for the user and bad for your lighthouse score.

Luckily, layout shift is a well understood problem with a large ecosystem of solutions.

I'm particularly fond of HeadlessUI's [Transition component](https://headlessui.dev/react/transition). It's a React component that lets you define a transition between two states, such as "hidden" and "visible". It's also very easy to use with Tailwind.

We can use the Transition component to fade in the date after the page loads, controlled by the `useHydrated` hook.

```tsx
function AppearWhenHydrated({
  children,
}: {
  children: React.ReactNode
}) {
  const isHydrated = useHydrated()
  return (
    <Transition
      show={isHydrated}
      appear
      as={Fragment}
      enter="transition-opacity ease-out duration-300"
      enterFrom="opacity-0"
      enterTo="opacity-100"
      leave="duration-0"
    >
      {children}
    </Transition>
  )
}
```

Now we can wrap our date in the `AppearWhenHydrated` component and it will fade in 300ms after the page loads, with no hydration or timezone issues.

```tsx
function Example() {
  const { date } = useLoaderData()

  return (
    <p>
      <AppearWhenHydrated>
        {date.toLocaleDateString()}
      </AppearWhenHydrated>
    </p>
  )
}
```
